<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Hub (Secured UI)</title>
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/svgs/solid/cloud.svg">
<link rel="stylesheet" href="admin-panel-src/css/admin-core.css">
<link rel="stylesheet" href="admin-panel-src/css/feedback.css">
<link rel="stylesheet" href="admin-panel-src/css/blog.css">
<link rel="stylesheet" href="admin-panel-src/css/page.css">
</head>
<body>
    <header class="app-header">
        <h1>Admin Hub</h1>
        <div class="header-controls">
           
            <button class="notification-btn" id="notification-btn" title="Notifications">
                üîî <span class="badge" id="notification-count" style="display:none;">0</span>
            </button>
            <div class="theme-switch">
                <span>‚òÄÔ∏è</span><label class="switch"><input type="checkbox" id="theme-toggle"><span class="slider"></span></label><span>üåô</span>
                 <a href="/admin-panel/file-manager.html" class="notification-btn" title="Go to File Manager">
                <i class="fas fa-folder"></i>
            </a>
            </div>
        </div>
    </header>

    <div class="main-container">
        <div id="list-container" class="screen active">
            <div class="dash-section">
                <button id="dashboard-toggle" class="dash-header" aria-expanded="false" type="button">
                    <span>üìä Dashboard</span>
                    <span class="chev">‚ñº</span>
                </button>

                <div id="dashboard-content" class="dash-content">
                    <div class="dash-content-inner">

                        <div class="stats-grid">
                            <div class="stat-card stat-btn" data-type="total">
                                <p class="title">Total Feedbacks</p>
                                <h2 id="stats-total" class="value">...</h2>
                            </div>
                            <div class="stat-card stat-btn" data-type="average">
                                <p class="title">Average Rating</p>
                                <h2 id="stats-avg-rating" class="value">...</h2>
                            </div>
                            <div class="stat-card stat-btn" data-type="replies">
                                <p class="title">Total Replies</p>
                                <h2 id="stats-replies" class="value">...</h2>
                            </div>
                            <div class="stat-card stat-btn" data-type="pinned">
                                <p class="title">Pinned Items</p>
                                <h2 id="stats-pinned" class="value">...</h2>
                            </div>
                            <div class="stat-card stat-btn" data-type="session">
                                <strong><span id="admin-username-display">Loading...</span></strong>
                                <span id="admin-login-timestamp-display">Loading...</span>
                            </div>
                            <div class="stat-card stat-btn" data-type="addblog">
                                <p class="title"><i class="fas fa-blog"></i> Add Blog</p>
                                <h2 class="value"><i class="fas fa-plus-circle"></i></h2>
                            </div>
                            <div class="stat-card" id="createPageBtn">
                                <p class="title"><i class="fas fa-plus"></i> Create Page</p>
                                <h2 class="value"><i class="fas fa-plus-circle"></i></h2>
                            </div>
                            <div class="stat-card" id="logout-btn">
                                <p class="title"><i class="fas fa-sign-out-alt"></i> Logout</p>
                                <h2 class="value"><i class="fas fa-sign-out-alt"></i></h2>
                            </div>
                        </div>

                        <div id="stat-modal-overlay" class="modal-overlay" style="display:none;">
                            <div class="modal-content stat-modal-content">
                                <h3 id="stat-modal-title"></h3>
                                <div id="stat-modal-body" style="margin: 1.1rem 0 1.7rem 0;"></div>
                                <div class="modal-actions">
                                    <button onclick="closeStatModal()" class="modal-btn cancel">Close</button>
                                </div>
                            </div>
                        </div>

                        <div id="blog-modal-overlay" class="modal-overlay" style="display:none;">
                            <div class="modal-content stat-modal-content">
                                <div class="blog-modal-inner">
                                    <h3><i class="fas fa-blog"></i> Manage Blogs</h3>
                                    <form id="add-blog-form" autocomplete="off">
                                        <label for="blog-link">File Link (e.g. <b>rdp.html</b>):</label>
                                        <input type="text" id="blog-link" placeholder="File name (e.g. rdp.html)" required>

                                        <label for="blog-title">Blog Title:</label>
                                        <input type="text" id="blog-title" placeholder="Blog title" required>

                                        <label for="blog-summary">Summary Text:</label>
                                        <textarea id="blog-summary" placeholder="Short description below the title" required rows="2"></textarea>

                                        <label for="blog-badge">Badge Text (optional):</label>
                                        <input type="text" id="blog-badge" placeholder="Badge (e.g. RDP)">

                                        <button type="submit"><i class="fas fa-plus"></i> Add Blog</button>
                                        <div id="msg-area"></div>
                                    </form>
                                    <div id="blog-admin-list"></div>
                                </div>
                                <div class="modal-actions">
                                    <button onclick="closeBlogModal()" class="modal-btn cancel">Close</button>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="list-toolbar">
                <div class="search-container">
                    <input type="text" id="search-input" placeholder="Search feedbacks by name or content...">
                </div>
                <div class="filter-buttons" id="filter-buttons">
                    <button class="active" data-filter="all">All</button>
                    <button data-filter="pinned">Pinned</button>
                    <button data-filter="replied">Replied</button>
                    <button data-filter="unreplied">Unreplied</button>
                </div>
                <button class="bulk-action-btn" onclick="tryDeleteSelectedFeedbacks()">Delete Selected</button>
            </div>
            <div class="feedback-list-container">
                <div class="feedback-list" id="feedback-list"><p style="text-align:center; padding: 2rem;">Loading feedbacks...</p></div>
            </div>
            <button id="load-more-btn" class="load-more-btn" style="display:none;" onclick="loadMoreFeedbacks(this)">
                <span class="btn-text">Load More</span>
                <span class="spinner-sm" style="display:none;"></span>
            </button>
        </div>
        <div id="detail-container" class="screen"></div>
        <div id="toast-container"></div>

        <div id="custom-confirm-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <h3 id="modal-title">Confirm Action</h3>
                <p id="modal-message">Are you sure you want to proceed?</p>
                <div class="modal-actions">
                    <button id="modal-confirm-btn" class="modal-btn confirm">Confirm</button>
                    <button id="modal-cancel-btn" class="modal-btn cancel">Cancel</button>
                </div>
            </div>
        </div>
        
        <div id="notif-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <h3>Notifications</h3>
                <div id="notif-list">
                    <div style="color:#ccc;text-align:center;margin:2rem 0;">Loading notifications...</div>
                </div>
                <div class="modal-actions">
                    <button onclick="document.getElementById('notif-modal').style.display = 'none';" class="modal-btn cancel">Close</button>
                </div>
            </div>
        </div>

        <div id="createPageModal" class="modal-overlay" style="display: none;">
            <div class="modal-content" style="max-width: 600px; padding: 25px;">
                <button class="close-modal-btn" id="closeCreatePageModalBtn">&times;</button>
                <h3>Create New HTML Page</h3>
                <form id="createPageForm">
                    <div class="form-group">
                        <label for="pageName">Page Filename (e.g., about.html):</label>
                        <input type="text" id="pageName" required placeholder="my-new-page.html">
                    </div>
                    <div class="form-group">
                        <label for="pageTitle">Page Title:</label>
                        <input type="text" id="pageTitle" required placeholder="My Awesome New Page">
                    </div>
                    <div class="form-group">
                        <label for="metaDescription">Meta Description:</label>
                        <input type="text" id="metaDescription" placeholder="A brief description of this page">
                    </div>
                    <div class="form-group">
                        <label for="metaKeywords">Meta Keywords (comma separated):</label>
                        <input type="text" id="metaKeywords" placeholder="keyword1, keyword2, important">
                    </div>
                    <div class="form-group">
                        <label for="websiteTitle">Website Title (e.g., My Awesome Site):</label>
                        <input type="text" id="websiteTitle" placeholder="My Awesome Site" required>
                    </div>
                    <div class="form-group">
                        <label for="heroTitle">Hero Title Here (e.g., Welcome to My Page!):</label>
                        <input type="text" id="heroTitle" placeholder="Welcome to My Page!" required>
                    </div>
                    <div class="form-group">
                        <label for="heroEmoji">Hero Emoji (e.g., ‚ú®):</label>
                        <input type="text" id="heroEmoji" placeholder="‚ú®">
                    </div>
                    <div class="form-group">
                        <label for="heroPara">Hero Paragraph Here (e.g., Discover amazing content.):</label>
                        <textarea id="heroPara" rows="3" placeholder="Discover amazing content." required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="pageContent">Page Body Content (HTML):</label>
                        <textarea id="pageContent" rows="10" required placeholder="<h1>Welcome to my new page!</h1><p>This is the main content.</p>"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="inlineCss">Inline CSS (optional):</label>
                        <textarea id="inlineCss" rows="5" placeholder="body { background-color: #f0f0f0; }"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="inlineJs">Inline JavaScript (optional):</label>
                        <textarea id="inlineJs" rows="5" placeholder="console.log('Page loaded!');"></textarea>
                    </div>
                    <div class="modal-actions" style="margin-top: 20px; display: flex; justify-content: flex-end; gap: 10px;">
                        <button type="button" class="modal-btn cancel" id="cancelCreatePageBtn">Cancel</button>
                        <button type="submit" class="modal-btn confirm" id="submitCreatePageBtn">Create Page</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
<script>
(function() {
    const toggle = document.getElementById('dashboard-toggle');
    const content = document.getElementById('dashboard-content');

    if (!toggle || !content) return;

    function setDashHeight() {
        if (content.classList.contains('open')) {
            content.style.maxHeight = content.scrollHeight + 'px';
        } else {
            content.style.maxHeight = '0px';
        }
    }

    // Init from saved state or default to closed
    const saved = localStorage.getItem('dashboardOpen');
    const shouldOpen = saved === '1';

    if (shouldOpen) {
        content.classList.add('open');
        toggle.setAttribute('aria-expanded', 'true');
    } else {
        content.classList.remove('open');
        toggle.setAttribute('aria-expanded', 'false');
    }
    setDashHeight();

    toggle.addEventListener('click', () => {
        const isOpen = !content.classList.contains('open');
        content.classList.toggle('open', isOpen);
        toggle.setAttribute('aria-expanded', String(isOpen));
        localStorage.setItem('dashboardOpen', isOpen ? '1' : '0');
        setDashHeight();
    });

    window.addEventListener('resize', setDashHeight);
})();
</script>
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script src="admin-panel-src/js/script.js"></script>
<script src="admin-panel-src/js/blog.js"></script>
<script src="admin-panel-src/js/feedback.js"></script>
<script src="admin-panel-src/js/page-creator.js"></script>
</body>
</html>